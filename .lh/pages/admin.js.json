{
    "sourceFile": "pages/admin.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1760669200924,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1760670193150,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,56 @@\n+import { useState, useEffect } from \"react\";\r\n+import { useRouter } from \"next/router\";\r\n+\r\n+export default function AdminPage() {\r\n+  const [input, setInput] = useState(\"\");\r\n+  const [error, setError] = useState(\"\");\r\n+  const router = useRouter();\r\n+  const PASSWORD = \"Detailing1313!\";\r\n+\r\n+  useEffect(() => {\r\n+    if (typeof window !== \"undefined\") {\r\n+      const saved = window.localStorage.getItem(\"adminAuth\");\r\n+      if (saved === PASSWORD) {\r\n+        router.replace(\"/adminDashboard\");\r\n+      }\r\n+    }\r\n+  }, [router]);\r\n+\r\n+  const handleSubmit = (e) => {\r\n+    e.preventDefault();\r\n+    if (input === PASSWORD) {\r\n+      window.localStorage.setItem(\"adminAuth\", PASSWORD);\r\n+      router.replace(\"/adminDashboard\");\r\n+    } else {\r\n+      setError(\"Incorrect password. Please try again.\");\r\n+    }\r\n+  };\r\n+\r\n+  return (\r\n+    <div className=\"min-h-screen flex items-center justify-center bg-blue-50\">\r\n+      <div className=\"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border border-blue-100\">\r\n+        <h2 className=\"text-2xl font-bold mb-6 text-center\" style={{ color: '#000' }}>Admin Login</h2>\r\n+        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n+          <div>\r\n+            <label className=\"block text-sm mb-2 text-gray-700\">Enter Password</label>\r\n+            <input\r\n+              type=\"password\"\r\n+              value={input}\r\n+              onChange={e => setInput(e.target.value)}\r\n+              className=\"w-full px-4 py-3 rounded-lg bg-white border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 outline-none text-gray-900\"\r\n+              placeholder=\"Password\"\r\n+              autoFocus\r\n+            />\r\n+            {error && <p className=\"text-sm text-red-600 mt-2\">{error}</p>}\r\n+          </div>\r\n+          <button\r\n+            type=\"submit\"\r\n+            className=\"w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition\"\r\n+          >\r\n+            Login\r\n+          </button>\r\n+        </form>\r\n+      </div>\r\n+    </div>\r\n+  );\r\n+}\r\n"
                },
                {
                    "date": 1761927992579,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,110 +1,75 @@\n-import { useState, useEffect } from \"react\";\r\n+import { useState } from \"react\";\r\n import { useRouter } from \"next/router\";\r\n \r\n export default function AdminPage() {\r\n-  const [input, setInput] = useState(\"\");\r\n+  const [password, setPassword] = useState(\"\");\r\n   const [error, setError] = useState(\"\");\r\n+  const [loading, setLoading] = useState(false);\r\n   const router = useRouter();\r\n-  const PASSWORD = \"Detailing1313!\";\r\n \r\n-  useEffect(() => {\r\n-    if (typeof window !== \"undefined\") {\r\n-      const saved = window.localStorage.getItem(\"adminAuth\");\r\n-      if (saved === PASSWORD) {\r\n-        router.replace(\"/adminDashboard\");\r\n+  const handleSubmit = async (e) => {\r\n+    e.preventDefault();\r\n+    setError(\"\");\r\n+    setLoading(true);\r\n+\r\n+    try {\r\n+      console.log(\"Attempting login...\");\r\n+      const response = await fetch(\"/api/auth/login\", {\r\n+        method: \"POST\",\r\n+        headers: { \"Content-Type\": \"application/json\" },\r\n+        body: JSON.stringify({ password }),\r\n+      });\r\n+\r\n+      console.log(\"Response status:\", response.status);\r\n+      const data = await response.json();\r\n+      console.log(\"Response data:\", data);\r\n+\r\n+      if (response.ok && data.success) {\r\n+        console.log(\"Login successful, redirecting to dashboard...\");\r\n+        // Login successful - httpOnly cookie is set automatically\r\n+        await router.replace(\"/adminDashboard\");\r\n+      } else {\r\n+        console.error(\"Login failed:\", data.error);\r\n+        setError(data.error || \"Invalid password. Please try again.\");\r\n+        setLoading(false);\r\n       }\r\n+    } catch (err) {\r\n+      console.error(\"Login error:\", err);\r\n+      setError(\"Failed to login. Please try again.\");\r\n+      setLoading(false);\r\n     }\r\n-  }, [router]);\r\n-\r\n-  const handleSubmit = (e) => {\r\n-    e.preventDefault();\r\n-    if (input === PASSWORD) {\r\n-      window.localStorage.setItem(\"adminAuth\", PASSWORD);\r\n-      router.replace(\"/adminDashboard\");\r\n-    } else {\r\n-      setError(\"Incorrect password. Please try again.\");\r\n-    }\r\n   };\r\n \r\n   return (\r\n     <div className=\"min-h-screen flex items-center justify-center bg-blue-50\">\r\n       <div className=\"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border border-blue-100\">\r\n-        <h2 className=\"text-2xl font-bold mb-6 text-center\" style={{ color: '#000' }}>Admin Login</h2>\r\n+        <h2 className=\"text-2xl font-bold mb-6 text-center\" style={{ color: '#000' }}>\r\n+          Admin Login\r\n+        </h2>\r\n         <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n           <div>\r\n             <label className=\"block text-sm mb-2 text-gray-700\">Enter Password</label>\r\n             <input\r\n               type=\"password\"\r\n-              value={input}\r\n-              onChange={e => setInput(e.target.value)}\r\n+              value={password}\r\n+              onChange={(e) => setPassword(e.target.value)}\r\n               className=\"w-full px-4 py-3 rounded-lg bg-white border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 outline-none text-gray-900\"\r\n               placeholder=\"Password\"\r\n               autoFocus\r\n+              disabled={loading}\r\n+              required\r\n             />\r\n             {error && <p className=\"text-sm text-red-600 mt-2\">{error}</p>}\r\n           </div>\r\n           <button\r\n             type=\"submit\"\r\n-            className=\"w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition\"\r\n+            className=\"w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed\"\r\n+            disabled={loading}\r\n           >\r\n-            Login\r\n+            {loading ? \"Logging in...\" : \"Login\"}\r\n           </button>\r\n         </form>\r\n       </div>\r\n     </div>\r\n   );\r\n }\r\n-import { useState } from \"react\";\r\n-\r\n-export default function AdminPage() {\r\n-  const [input, setInput] = useState(\"\");\r\n-  const [error, setError] = useState(\"\");\r\n-  const [access, setAccess] = useState(false);\r\n-  const PASSWORD = \"Detailing1313!\";\r\n-\r\n-  const handleSubmit = (e) => {\r\n-    e.preventDefault();\r\n-    if (input === PASSWORD) {\r\n-      setAccess(true);\r\n-      setError(\"\");\r\n-    } else {\r\n-      setError(\"Incorrect password. Please try again.\");\r\n-      setAccess(false);\r\n-    }\r\n-  };\r\n-\r\n-  return (\r\n-    <div className=\"min-h-screen flex items-center justify-center bg-blue-50\">\r\n-      <div className=\"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border border-blue-100\">\r\n-        <h2 className=\"text-2xl font-bold mb-6 text-blue-700 text-center\">Admin Login</h2>\r\n-        {!access ? (\r\n-          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n-            <div>\r\n-              <label className=\"block text-sm mb-2 text-gray-700\">Enter Password</label>\r\n-              <input\r\n-                type=\"password\"\r\n-                value={input}\r\n-                onChange={e => setInput(e.target.value)}\r\n-                className=\"w-full px-4 py-3 rounded-lg bg-white border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 outline-none text-gray-900\"\r\n-                placeholder=\"Password\"\r\n-                autoFocus\r\n-              />\r\n-              {error && <p className=\"text-sm text-red-600 mt-2\">{error}</p>}\r\n-            </div>\r\n-            <button\r\n-              type=\"submit\"\r\n-              className=\"w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition\"\r\n-            >\r\n-              Login\r\n-            </button>\r\n-          </form>\r\n-        ) : (\r\n-          <div className=\"text-center py-10\">\r\n-            <h3 className=\"text-xl font-bold text-blue-600 mb-4\">Access Granted</h3>\r\n-            <p className=\"text-gray-700\">Welcome to the admin area.</p>\r\n-          </div>\r\n-        )}\r\n-      </div>\r\n-    </div>\r\n-  );\r\n-}\r\n"
                }
            ],
            "date": 1760669200924,
            "name": "Commit-0",
            "content": "import { useState } from \"react\";\r\n\r\nexport default function AdminPage() {\r\n  const [input, setInput] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [access, setAccess] = useState(false);\r\n  const PASSWORD = \"Detailing1313!\";\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (input === PASSWORD) {\r\n      setAccess(true);\r\n      setError(\"\");\r\n    } else {\r\n      setError(\"Incorrect password. Please try again.\");\r\n      setAccess(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-blue-50\">\r\n      <div className=\"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border border-blue-100\">\r\n        <h2 className=\"text-2xl font-bold mb-6 text-blue-700 text-center\">Admin Login</h2>\r\n        {!access ? (\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            <div>\r\n              <label className=\"block text-sm mb-2 text-gray-700\">Enter Password</label>\r\n              <input\r\n                type=\"password\"\r\n                value={input}\r\n                onChange={e => setInput(e.target.value)}\r\n                className=\"w-full px-4 py-3 rounded-lg bg-white border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 outline-none text-gray-900\"\r\n                placeholder=\"Password\"\r\n                autoFocus\r\n              />\r\n              {error && <p className=\"text-sm text-red-600 mt-2\">{error}</p>}\r\n            </div>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition\"\r\n            >\r\n              Login\r\n            </button>\r\n          </form>\r\n        ) : (\r\n          <div className=\"text-center py-10\">\r\n            <h3 className=\"text-xl font-bold text-blue-600 mb-4\">Access Granted</h3>\r\n            <p className=\"text-gray-700\">Welcome to the admin area.</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"
        }
    ]
}