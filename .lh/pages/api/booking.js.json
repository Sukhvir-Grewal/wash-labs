{
    "sourceFile": "pages/api/booking.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1757955580780,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1757957896503,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,67 @@\n+import nodemailer from \"nodemailer\";\r\n+\r\n+export default async function handler(req, res) {\r\n+    if (req.method !== \"POST\") {\r\n+        return res.status(405).json({ message: \"Method not allowed\" });\r\n+    }\r\n+\r\n+    const { service, vehicle, dateTime, userInfo } = req.body;\r\n+\r\n+    if (!service || !vehicle || !dateTime || !userInfo) {\r\n+        return res.status(400).json({ message: \"Missing booking details\" });\r\n+    }\r\n+\r\n+    try {\r\n+        const transporter = nodemailer.createTransport({\r\n+            service: \"gmail\",\r\n+            auth: {\r\n+                user: process.env.EMAIL_USER,\r\n+                pass: process.env.EMAIL_PASS,\r\n+            },\r\n+        });\r\n+\r\n+        // Compose the booking email\r\n+        const mailOptions = {\r\n+            from: `\"WashLabs Booking\" <no-reply@washlabs.ca>`,\r\n+            to: \"washlabs.ca@gmail.com\",\r\n+            subject: `‚úÖ New Booking Request - ${service.title}`,\r\n+            html: `\r\n+        <h2 style=\"color:#22c55e;\">New Booking Request</h2>\r\n+        \r\n+        <h3 style=\"color:#f97316;\">Service</h3>\r\n+        <p><strong>${service.title}</strong></p>\r\n+        <p>${service.price ? \"Price: $\" + service.price : \"\"}</p>\r\n+\r\n+        <h3 style=\"color:#f97316;\">Vehicle</h3>\r\n+        <p>${vehicle.year} ${vehicle.name}</p>\r\n+\r\n+        <h3 style=\"color:#f97316;\">Date & Time</h3>\r\n+        <p>${dateTime.date || \"N/A\"} at ${dateTime.time || \"N/A\"}</p>\r\n+\r\n+        <h3 style=\"color:#f97316;\">Client Information</h3>\r\n+        <p><strong>Name:</strong> ${userInfo.name}</p>\r\n+        <p><strong>Email:</strong> ${userInfo.email}</p>\r\n+        <p><strong>Phone:</strong> ${userInfo.countryCode || \"\"} ${\r\n+                userInfo.phone\r\n+            }</p>\r\n+        ${\r\n+            userInfo.message\r\n+                ? `<p><strong>Notes:</strong><br/>${userInfo.message}</p>`\r\n+                : \"\"\r\n+        }\r\n+\r\n+        <hr />\r\n+        <p style=\"font-size:0.9rem;color:gray;\">\r\n+          This booking was submitted from the WashLabs website booking form.\r\n+        </p>\r\n+      `,\r\n+        };\r\n+\r\n+        await transporter.sendMail(mailOptions);\r\n+\r\n+        return res.status(200).json({ message: \"Booking sent successfully\" });\r\n+    } catch (error) {\r\n+        console.error(\"Error sending booking email:\", error);\r\n+        return res.status(500).json({ message: \"Failed to send booking\" });\r\n+    }\r\n+}\r\n"
                },
                {
                    "date": 1757957913572,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,9 +21,9 @@\n         });\r\n \r\n         // Compose the booking email\r\n         const mailOptions = {\r\n-            from: `\"WashLabs Booking\" <no-reply@washlabs.ca>`,\r\n+            from: `\"WashLabs Booking\" <${process.env.EMAIL_USER}>`,\r\n             to: \"washlabs.ca@gmail.com\",\r\n             subject: `‚úÖ New Booking Request - ${service.title}`,\r\n             html: `\r\n         <h2 style=\"color:#22c55e;\">New Booking Request</h2>\r\n"
                },
                {
                    "date": 1758176244649,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,32 +1,32 @@\n import nodemailer from \"nodemailer\";\r\n \r\n export default async function handler(req, res) {\r\n-    if (req.method !== \"POST\") {\r\n-        return res.status(405).json({ message: \"Method not allowed\" });\r\n-    }\r\n+  if (req.method !== \"POST\") {\r\n+    return res.status(405).json({ message: \"Method not allowed\" });\r\n+  }\r\n \r\n-    const { service, vehicle, dateTime, userInfo } = req.body;\r\n+  const { service, vehicle, dateTime, userInfo } = req.body;\r\n \r\n-    if (!service || !vehicle || !dateTime || !userInfo) {\r\n-        return res.status(400).json({ message: \"Missing booking details\" });\r\n-    }\r\n+  if (!service || !vehicle || !dateTime || !userInfo) {\r\n+    return res.status(400).json({ message: \"Missing booking details\" });\r\n+  }\r\n \r\n-    try {\r\n-        const transporter = nodemailer.createTransport({\r\n-            service: \"gmail\",\r\n-            auth: {\r\n-                user: process.env.EMAIL_USER,\r\n-                pass: process.env.EMAIL_PASS,\r\n-            },\r\n-        });\r\n+  try {\r\n+    const transporter = nodemailer.createTransport({\r\n+      service: \"gmail\",\r\n+      auth: {\r\n+        user: process.env.EMAIL_USER,\r\n+        pass: process.env.EMAIL_PASS,\r\n+      },\r\n+    });\r\n \r\n-        // Compose the booking email\r\n-        const mailOptions = {\r\n-            from: `\"WashLabs Booking\" <${process.env.EMAIL_USER}>`,\r\n-            to: \"washlabs.ca@gmail.com\",\r\n-            subject: `‚úÖ New Booking Request - ${service.title}`,\r\n-            html: `\r\n+    // üì© Admin notification email\r\n+    const mailOptions = {\r\n+      from: `\"WashLabs Booking\" <${process.env.EMAIL_USER}>`,\r\n+      to: \"washlabs.ca@gmail.com\",\r\n+      subject: `‚úÖ New Booking Request - ${service.title}`,\r\n+      html: `\r\n         <h2 style=\"color:#22c55e;\">New Booking Request</h2>\r\n         \r\n         <h3 style=\"color:#f97316;\">Service</h3>\r\n         <p><strong>${service.title}</strong></p>\r\n@@ -41,27 +41,66 @@\n         <h3 style=\"color:#f97316;\">Client Information</h3>\r\n         <p><strong>Name:</strong> ${userInfo.name}</p>\r\n         <p><strong>Email:</strong> ${userInfo.email}</p>\r\n         <p><strong>Phone:</strong> ${userInfo.countryCode || \"\"} ${\r\n-                userInfo.phone\r\n-            }</p>\r\n+        userInfo.phone\r\n+      }</p>\r\n         ${\r\n-            userInfo.message\r\n-                ? `<p><strong>Notes:</strong><br/>${userInfo.message}</p>`\r\n-                : \"\"\r\n+          userInfo.message\r\n+            ? `<p><strong>Notes:</strong><br/>${userInfo.message}</p>`\r\n+            : \"\"\r\n         }\r\n \r\n         <hr />\r\n         <p style=\"font-size:0.9rem;color:gray;\">\r\n           This booking was submitted from the WashLabs website booking form.\r\n         </p>\r\n       `,\r\n-        };\r\n+    };\r\n \r\n-        await transporter.sendMail(mailOptions);\r\n+    await transporter.sendMail(mailOptions);\r\n \r\n-        return res.status(200).json({ message: \"Booking sent successfully\" });\r\n-    } catch (error) {\r\n-        console.error(\"Error sending booking email:\", error);\r\n-        return res.status(500).json({ message: \"Failed to send booking\" });\r\n-    }\r\n+    // üì© Confirmation email to applicant\r\n+    const confirmationMail = {\r\n+      from: `\"WashLabs\" <${process.env.EMAIL_USER}>`,\r\n+      to: userInfo.email,\r\n+      subject: `üßΩ Booking Confirmation - ${service.title}`,\r\n+      html: `\r\n+        <div style=\"font-family:Arial, sans-serif; line-height:1.6; color:#333;\">\r\n+          <h2 style=\"color:#22c55e;\">Thank you for your booking, ${\r\n+            userInfo.name\r\n+          }! üéâ</h2>\r\n+          <p>We‚Äôve received your request and our team will contact you if any additional details are needed.</p>\r\n+\r\n+          <h3 style=\"color:#f97316;\">Booking Summary</h3>\r\n+          <p><strong>Service:</strong> ${service.title} ${\r\n+        service.price ? `- $${service.price}` : \"\"\r\n+      }</p>\r\n+          <p><strong>Vehicle:</strong> ${vehicle.year} ${vehicle.name}</p>\r\n+          <p><strong>Date & Time:</strong> ${\r\n+            dateTime.date || \"N/A\"\r\n+          } at ${dateTime.time || \"N/A\"}</p>\r\n+\r\n+          ${\r\n+            userInfo.message\r\n+              ? `<p><strong>Your Notes:</strong><br/>${userInfo.message}</p>`\r\n+              : \"\"\r\n+          }\r\n+\r\n+          <hr/>\r\n+          <p style=\"font-size:0.9rem; color:gray;\">\r\n+            WashLabs Team<br/>\r\n+            üìç Halifax / Dartmouth / Bedford<br/>\r\n+            ‚úâÔ∏è washlabs.ca@gmail.com\r\n+          </p>\r\n+        </div>\r\n+      `,\r\n+    };\r\n+\r\n+    await transporter.sendMail(confirmationMail);\r\n+\r\n+    return res.status(200).json({ message: \"Booking and confirmation sent successfully\" });\r\n+  } catch (error) {\r\n+    console.error(\"Error sending booking email:\", error);\r\n+    return res.status(500).json({ message: \"Failed to send booking\" });\r\n+  }\r\n }\r\n"
                },
                {
                    "date": 1758176622129,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,96 @@\n+import nodemailer from \"nodemailer\";\r\n+\r\n+export default async function handler(req, res) {\r\n+  if (req.method !== \"POST\") {\r\n+    return res.status(405).json({ message: \"Method not allowed\" });\r\n+  }\r\n+\r\n+  const { service, vehicle, dateTime, userInfo } = req.body;\r\n+\r\n+  if (!service || !vehicle || !dateTime || !userInfo) {\r\n+    return res.status(400).json({ message: \"Missing booking details\" });\r\n+  }\r\n+\r\n+  try {\r\n+    const transporter = nodemailer.createTransport({\r\n+      service: \"gmail\",\r\n+      auth: {\r\n+        user: process.env.EMAIL_USER,\r\n+        pass: process.env.EMAIL_PASS,\r\n+      },\r\n+    });\r\n+\r\n+    // üì© Admin notification email\r\n+    const adminMail = {\r\n+      from: `\"WashLabs Booking\" <${process.env.EMAIL_USER}>`,\r\n+      to: \"washlabs.ca@gmail.com\",\r\n+      subject: `‚úÖ New Booking Request - ${service.title}`,\r\n+      html: `\r\n+        <h2 style=\"color:#22c55e;\">New Booking Request</h2>\r\n+        \r\n+        <h3 style=\"color:#f97316;\">Service</h3>\r\n+        <p><strong>${service.title}</strong></p>\r\n+        <p>${service.price ? \"Price: $\" + service.price : \"\"}</p>\r\n+\r\n+        <h3 style=\"color:#f97316;\">Vehicle</h3>\r\n+        <p>${vehicle.year} ${vehicle.name}</p>\r\n+\r\n+        <h3 style=\"color:#f97316;\">Date & Time</h3>\r\n+        <p>${dateTime.date || \"N/A\"} at ${dateTime.time || \"N/A\"}</p>\r\n+\r\n+        <h3 style=\"color:#f97316;\">Client Information</h3>\r\n+        <p><strong>Name:</strong> ${userInfo.name}</p>\r\n+        <p><strong>Email:</strong> ${userInfo.email}</p>\r\n+        <p><strong>Phone:</strong> ${userInfo.countryCode || \"\"} ${userInfo.phone}</p>\r\n+        ${\r\n+          userInfo.message\r\n+            ? `<p><strong>Notes:</strong><br/>${userInfo.message}</p>`\r\n+            : \"\"\r\n+        }\r\n+\r\n+        <hr />\r\n+        <p style=\"font-size:0.9rem;color:gray;\">\r\n+          This booking was submitted from the WashLabs website booking form.\r\n+        </p>\r\n+      `,\r\n+      replyTo: userInfo.email, // ‚úÖ lets you reply directly to client\r\n+    };\r\n+\r\n+    await transporter.sendMail(adminMail);\r\n+\r\n+    // üì© Confirmation email to applicant (No Reply)\r\n+    const confirmationMail = {\r\n+      from: `\"WashLabs (No Reply)\" <no-reply@washlabs.ca>`, // ‚úÖ noreply\r\n+      to: userInfo.email,\r\n+      subject: `üßΩ Booking Confirmation - ${service.title}`,\r\n+      html: `\r\n+        <div style=\"font-family:Arial, sans-serif; line-height:1.6; color:#333;\">\r\n+          <h2 style=\"color:#22c55e;\">Thank you for your booking, ${userInfo.name}! üéâ</h2>\r\n+          <p>We‚Äôve received your request and our team will contact you if any additional details are needed.</p>\r\n+\r\n+          <h3 style=\"color:#f97316;\">Booking Summary</h3>\r\n+          <p><strong>Service:</strong> ${service.title} ${service.price ? `- $${service.price}` : \"\"}</p>\r\n+          <p><strong>Vehicle:</strong> ${vehicle.year} ${vehicle.name}</p>\r\n+          <p><strong>Date & Time:</strong> ${dateTime.date || \"N/A\"} at ${dateTime.time || \"N/A\"}</p>\r\n+\r\n+          ${userInfo.message ? `<p><strong>Your Notes:</strong><br/>${userInfo.message}</p>` : \"\"}\r\n+\r\n+          <hr/>\r\n+          <p style=\"font-size:0.9rem; color:gray;\">\r\n+            WashLabs Team<br/>\r\n+            üìç Halifax / Dartmouth / Bedford<br/>\r\n+            ‚úâÔ∏è washlabs.ca@gmail.com<br/>\r\n+            ‚ö†Ô∏è This is an automated message from a no-reply address. Please do not reply directly.\r\n+          </p>\r\n+        </div>\r\n+      `,\r\n+    };\r\n+\r\n+    await transporter.sendMail(confirmationMail);\r\n+\r\n+    return res.status(200).json({ message: \"Booking and confirmation sent successfully\" });\r\n+  } catch (error) {\r\n+    console.error(\"Error sending booking email:\", error);\r\n+    return res.status(500).json({ message: \"Failed to send booking\" });\r\n+  }\r\n+}\r\n"
                }
            ],
            "date": 1757955580780,
            "name": "Commit-0",
            "content": "import nodemailer from \"nodemailer\";\r\n\r\nexport default async function handler(req, res) {\r\n  if (req.method !== \"POST\") {\r\n    return res.status(405).json({ message: \"Method not allowed\" });\r\n  }\r\n\r\n  const { service, vehicle, dateTime, userInfo } = req.body;\r\n\r\n  if (!service || !vehicle || !dateTime || !userInfo) {\r\n    return res.status(400).json({ message: \"Missing booking details\" });\r\n  }\r\n\r\n  try {\r\n    const transporter = nodemailer.createTransport({\r\n      service: \"gmail\",\r\n      auth: {\r\n        user: process.env.EMAIL_USER,\r\n        pass: process.env.EMAIL_PASS,\r\n      },\r\n    });\r\n\r\n    // Compose the booking email\r\n    const mailOptions = {\r\n      from: `\"WashLabs Booking\" <${process.env.EMAIL_USER}>`,\r\n      to: \"washlabs.ca@gmail.com\",\r\n      subject: `‚úÖ New Booking Request - ${service.title}`,\r\n      html: `\r\n        <h2 style=\"color:#22c55e;\">New Booking Request</h2>\r\n        \r\n        <h3 style=\"color:#f97316;\">Service</h3>\r\n        <p><strong>${service.title}</strong></p>\r\n        <p>${service.price ? \"Price: $\" + service.price : \"\"}</p>\r\n\r\n        <h3 style=\"color:#f97316;\">Vehicle</h3>\r\n        <p>${vehicle.year} ${vehicle.name}</p>\r\n\r\n        <h3 style=\"color:#f97316;\">Date & Time</h3>\r\n        <p>${dateTime.date || \"N/A\"} at ${dateTime.time || \"N/A\"}</p>\r\n\r\n        <h3 style=\"color:#f97316;\">Client Information</h3>\r\n        <p><strong>Name:</strong> ${userInfo.name}</p>\r\n        <p><strong>Email:</strong> ${userInfo.email}</p>\r\n        <p><strong>Phone:</strong> ${userInfo.countryCode || \"\"} ${userInfo.phone}</p>\r\n        ${\r\n          userInfo.message\r\n            ? `<p><strong>Notes:</strong><br/>${userInfo.message}</p>`\r\n            : \"\"\r\n        }\r\n\r\n        <hr />\r\n        <p style=\"font-size:0.9rem;color:gray;\">\r\n          This booking was submitted from the WashLabs website booking form.\r\n        </p>\r\n      `,\r\n    };\r\n\r\n    await transporter.sendMail(mailOptions);\r\n\r\n    return res.status(200).json({ message: \"Booking sent successfully\" });\r\n  } catch (error) {\r\n    console.error(\"Error sending booking email:\", error);\r\n    return res.status(500).json({ message: \"Failed to send booking\" });\r\n  }\r\n}\r\n"
        }
    ]
}